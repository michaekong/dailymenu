<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau de Bord - dailyMenu</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
      <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
   
    <style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;900&display=swap');

:root {
    --rouge-brique: #8B2323;
    --rouge-doux: #A24E4E;
    --rose-pale: #E7D3D3;
    --jaune-creme: #FFF1CF;
    --bleu-clair: #CCE5FF;
    --glass-bg: rgba(231, 211, 211, 0.3);
    --glow-shadow: 0 0 20px rgba(162, 78, 78, 0.6);
}

body {
    background: linear-gradient(135deg, var(--rose-pale), var(--jaune-creme), var(--bleu-clair));
    font-family: 'Poppins', sans-serif;
    color: var(--rouge-brique);
    overflow-x-hidden;
    animation: gradientShift 20s ease infinite;
}

@keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

h1, h2, h3 {
    font-family: 'Poppins', sans-serif;
    font-weight: 900;
    color: var(--rouge-brique);
    text-shadow: 0 0 10px rgba(139, 35, 35, 0.4);
}

.bg-glass {
    background: var(--glass-bg);
    backdrop-filter: blur(12px);
    border: 1px solid rgba(162, 78, 78, 0.25);
}

.card-shadow {
    box-shadow: var(--glow-shadow), 0 4px 15px rgba(0, 0, 0, 0.15);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.card-shadow:hover {
    transform: translateY(-8px) rotateX(2deg);
    box-shadow: 0 0 30px rgba(162, 78, 78, 0.8), 0 8px 25px rgba(0, 0, 0, 0.2);
}

.btn-primary {
    background: linear-gradient(45deg, var(--rouge-brique), var(--rouge-doux));
    color: white;
    border: none;
    padding: 0.75rem 1.75rem;
    border-radius: 0.5rem;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    animation: pulse 2s infinite;
}

.btn-primary::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    background: rgba(255, 255, 255, 0.4);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    transition: width 0.4s ease, height 0.4s ease;
}

.btn-primary:hover::after {
    width: 200%;
    height: 200%;
}

.btn-primary:hover {
    transform: scale(1.1);
    box-shadow: var(--glow-shadow);
}

@keyframes pulse {
    0% { box-shadow: 0 0 5px var(--rouge-doux); }
    50% { box-shadow: 0 0 25px rgba(162, 78, 78, 0.6); }
    100% { box-shadow: 0 0 5px var(--rouge-doux); }
}

.nav-item {
    padding: 0.5rem 1rem;
    transition: all 0.3s ease;
    border-radius: 0.5rem;
}

.nav-item:hover {
    background: var(--jaune-creme);
    transform: translateX(6px);
    box-shadow: var(--glow-shadow);
}

.nav-item.active {
    background: var(--rouge-doux);
    color: white;
    box-shadow: var(--glow-shadow);
}

.sidebar {
    width: 100%;
    max-width: 16rem;
    background: linear-gradient(to bottom, var(--glass-bg), rgba(162, 78, 78, 0.1));
    backdrop-filter: blur(12px);
    transition: transform 0.5s cubic-bezier(0.68, -0.45, 0.265, 1.55);
    box-shadow: var(--glow-shadow);
}

@media (min-width: 640px) { .sidebar { max-width: 18rem; } }
@media (min-width: 1024px) { .sidebar { max-width: 20rem; } }

.sidebar-hidden { transform: translateX(-100%); }

.backdrop { transition: opacity 0.4s ease; }

@media (min-width: 768px) {
    .sidebar { transform: translateX(0) !important; }
    .backdrop { display: none !important; }
    #main-content { margin-left: 18rem; }
}

@media (min-width: 1024px) { #main-content { margin-left: 20rem; } }

main {
    padding: clamp(0.5rem, 2vw, 1rem);
    animation: fadeIn 1s ease-out;
}

@media (min-width: 640px) { main { padding: clamp(1rem, 2.5vw, 1.5rem); } }
@media (min-width: 768px) { main { padding: clamp(1.5rem, 3vw, 2rem); } }
@media (min-width: 1024px) { main { padding: clamp(2rem, 3.5vw, 3rem); } }

.fade-in-section {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}

.fade-in-section.visible {
    opacity: 1;
    transform: translateY(0);
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.modal {
    background: rgba(139, 35, 35, 0.5);
    backdrop-filter: blur(15px);
    animation: zoomIn 0.5s ease-out;
}

@keyframes zoomIn {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
}

.modal-content {
    background: var(--glass-bg);
    backdrop-filter: blur(12px);
    border: 2px solid var(--rouge-doux);
    box-shadow: var(--glow-shadow);
    width: 100%;
    max-width: calc(90vw - 1rem);
    max-height: calc(90vh - 2rem);
    padding: clamp(1rem, 2.5vw, 1.5rem);
    border-radius: 1rem;
    overflow-y: auto;
    animation: pulseModal 3s infinite;
}

@keyframes pulseModal {
    0% { box-shadow: 0 0 10px var(--rouge-doux); }
    50% { box-shadow: 0 0 30px var(--rouge-doux); }
    100% { box-shadow: 0 0 10px var(--rouge-doux); }
}

@media (min-width: 640px) { .modal-content { max-width: 36rem; padding: 2rem; } }
@media (min-width: 768px) { .modal-content { max-width: 44rem; } }
@media (min-width: 1024px) { .modal-content { max-width: 60rem; } }
@media (min-width: 1280px) { .modal-content { max-width: 68rem; } }

/* Styles existants pour les groupes de formulaires et les champs... */

/* Votre définition des variables de couleurs */
:root {
    --rouge-brique: #8B2323;
    --rouge-doux: #A24E4E;
    --rose-pale: #E7D3D3;
    --jaune-creme: #FFF1CF;
    --bleu-clair: #CCE5FF;
    --glass-bg: rgba(231, 211, 211, 0.3);
    --glow-shadow: 0 0 20px rgba(162, 78, 78, 0.6);
}

/* Style pour le conteneur du formulaire */
form, .form-container { /* Ciblez la balise <form> ou un div avec la classe .form-container */
    background-color: var(--rose-pale); /* L'arrière-plan du formulaire */
    padding: 2rem; /* Espace intérieur pour que les champs ne soient pas collés aux bords */
    border-radius: 1rem; /* Bords légèrement arrondis pour une touche douce */
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05); /* Une ombre très légère pour la profondeur */
}

/* Les styles précédents pour .form-group, input, label, etc., restent inchangés */
.form-group {
    position: relative;
    margin-bottom: clamp(1.25rem, 2.5vw, 1.75rem);
}

.form-group input,
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 0.75rem 1rem;
    padding-left: 3rem;
    font-size: clamp(0.875rem, 1.75vw, 1rem);
    border: 1px solid var(--rose-pale);
    border-radius: 0.5rem;
    outline: none;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
    color: var(--rouge-brique);
    background-color: var(--jaune-creme);
}

.form-group textarea {
    min-height: 5rem;
    resize: vertical;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    border-color: var(--rouge-brique);
    box-shadow: var(--glow-shadow);
}

.form-group label {
    position: absolute;
    top: 0.75rem;
    left: 1rem;
    color: var(--rouge-doux);
    font-size: clamp(0.875rem, 1.75vw, 1rem);
    pointer-events: none;
    transition: all 0.2s ease-in-out;
}

.form-group input:focus + label,
.form-group input:not(:placeholder-shown) + label,
.form-group select:focus + label,
.form-group select:not(:placeholder-shown) + label,
.form-group textarea:focus + label,
.form-group textarea:not(:placeholder-shown) + label {
    top: -0.5rem;
    left: 0.75rem;
    font-size: clamp(0.75rem, 1.5vw, 0.875rem);
    color: var(--rouge-brique);
    background-color: var(--jaune-creme);
    padding: 0 0.25rem;
    border-radius: 0.25rem;
    z-index: 1;
}

.form-group .input-icon {
    position: absolute;
    top: 50%;
    left: 0.75rem;
    transform: translateY(-50%);
    width: 1.25rem;
    height: 1.25rem;
    fill: var(--rouge-doux);
    transition: fill 0.3s ease;
    pointer-events: none;
    z-index: 0;
}

.form-group input:focus + label + .input-icon,
.form-group select:focus + label + .input-icon,
.form-group textarea:focus + label + .input-icon {
    fill: var(--rouge-brique);
}

input:focus + .input-icon,
select:focus + .input-icon,
textarea:focus + .input-icon {
    transform: translateY(-50%) scale(1.2);
    stroke: var(--rouge-brique);
}

input, textarea, select {
    background: linear-gradient(45deg, var(--rose-pale), var(--jaune-creme));
    border: 1px solid var(--rouge-doux);
    color: var(--rouge-brique);
    padding: clamp(0.75rem, 1.5vw, 0.875rem) clamp(0.75rem, 1.5vw, 0.875rem) clamp(0.75rem, 1.5vw, 0.875rem) clamp(2.5rem, 3vw, 2.75rem);
    border-radius: 0.75rem;
    transition: all 0.3s ease;
    width: 100%;
    box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.05);
    position: relative;
}

input::after, textarea::after, select::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2));
    opacity: 0;
    transition: opacity 0.3s ease;
}

input:focus::after, textarea:focus::after, select:focus::after {
    opacity: 1;
}

input:focus, textarea:focus, select:focus {
    outline: none;
    border-color: var(--rouge-brique);
    box-shadow: 0 0 15px var(--glow-shadow);
    transform: scale(1.02);
}

input::placeholder, textarea::placeholder {
    color: rgba(139, 35, 35, 0.5);
}

.form-error {
    color: white;
    background: var(--rouge-brique);
    font-size: clamp(0.625rem, 1vw, 0.75rem);
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    margin-top: 0.3rem;
    opacity: 0;
    transition: opacity 0.3s ease, transform 0.3s ease;
}

.form-error.show {
    opacity: 1;
    transform: translateX(5px);
}

/* Cartes d'affichage */
.item-card, .menu-card {
    background: var(--glass-bg);
    border-radius: 1rem;
    padding: clamp(1rem, 2vw, 1.5rem);
    position: relative;
    overflow: hidden;
    transition: transform 0.3s ease;
}

.item-card::before, .menu-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAIElEQVQoU2NkYGBgYGBhYGBgYGBgYGBgYGBgYGBgYBAAAI8AB7fA3ugAAAAASUVORK5CYII=') repeat;
    opacity: 0.05;
}

.item-card:hover, .menu-card:hover {
    transform: scale(1.05) rotateX(3deg);
}

.item-card .card-icon, .menu-card .card-icon {
    width: 2rem;
    height: 2rem;
    stroke: var(--rouge-doux);
    margin-bottom: 0.5rem;
}

.action-buttons {
    display: flex;
    gap: 0.5rem;
    margin-top: 1rem;
}

.menu-button {
    padding: 0.5rem;
    border-radius: 0.5rem;
    background: var(--glass-bg);
    border: 1px solid var(--rouge-doux);
    transition: all 0.3s ease;
}

.menu-button:hover {
    background: var(--jaune-creme);
    transform: scale(1.1);
}

.menu-button .icon-svg {
    width: 1.25rem;
    height: 1.25rem;
    stroke: var(--rouge-brique);
}

/* Sections spécifiques */
#overview-section .stat-card {
    background: linear-gradient(135deg, var(--rouge-brique), var(--rouge-doux));
    color: white;
    border-radius: 0.75rem;
    padding: clamp(1.5rem, 2vw, 2rem);
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
}

#overview-section .stat-card .icon-svg {
    width: 2rem;
    height: 2rem;
    stroke: var(--jaune-creme);
    transition: transform 0.3s ease;
}

#overview-section .stat-card:hover .icon-svg {
    transform: scale(1.2) rotate(5deg);
}

#overview-section .stat-card h3 {
    color: var(--jaune-creme);
    font-size: clamp(1rem, 2vw, 1.25rem);
}

#overview-section .stat-card p {
    font-size: clamp(1.5rem, 3vw, 2.5rem);
    font-weight: 700;
}

#profile-section {
    background: var(--jaune-creme);
    border-radius: 1rem;
    padding: clamp(1.5rem, 3vw, 2rem);
    box-shadow: var(--glow-shadow);
}

#items-section .filter-container {
    background: var(--glass-bg);
    backdrop-filter: blur(12px);
    border-radius: 1rem;
    padding: clamp(1rem, 2vw, 1.5rem);
    margin-bottom: clamp(1.5rem, 2vw, 2rem);
    box-shadow: var(--glow-shadow);
}

#qr-codes-section .qr-code-preview {
    background: var(--bleu-clair);
    border-radius: 1rem;
    padding: clamp(1rem, 2vw, 1.5rem);
    text-align: center;
    animation: pulse 2s infinite;
}

#reviews-section .review-card {
    background: var(--glass-bg);
    border-radius: 1rem;
    padding: clamp(1rem, 2vw, 1.5rem);
    display: flex;
    align-items: center;
}

#reviews-section .review-card .stars {
    display: flex;
    gap: 0.25rem;
}

#reviews-section .review-card .stars svg {
    width: 1.5rem;
    height: 1.5rem;
    fill: var(--jaune-creme);
    transition: transform 0.3s ease;
}

#reviews-section .review-card .stars svg:hover {
    transform: scale(1.3);
}

#stats-section .chart-placeholder {
    background: var(--glass-bg);
    border-radius: 1rem;
    padding: clamp(2rem, 3vw, 2.5rem);
    text-align: center;
    animation: chartLoad 1.2s ease-in-out;
}

@keyframes chartLoad {
    from { opacity: 0; transform: translateY(15px); }
    to { opacity: 1; transform: translateY(0); }
}

.grid {
    gap: clamp(0.75rem, 2vw, 1.25rem);
}

@media (min-width: 640px) { .grid { gap: clamp(1rem, 2.5vw, 1.75rem); } }
@media (min-width: 768px) { .grid { gap: clamp(1.5rem, 3vw, 2.25rem); } }

#overview-section .grid { grid-template-columns: 1fr; }
@media (min-width: 640px) { #overview-section .grid { grid-template-columns: repeat(2, 1fr); } }
@media (min-width: 1024px) { #overview-section .grid { grid-template-columns: repeat(4, 1fr); } }

#items-list { grid-template-columns: 1fr; }
@media (min-width: 640px) { #items-list { grid-template-columns: repeat(2, 1fr); } }
@media (min-width: 1024px) { #items-list { grid-template-columns: repeat(3, 1fr); } }
@media (min-width: 1280px) { #items-list { grid-template-columns: repeat(4, 1fr); } }

#menus-list { grid-template-columns: 1fr; }
@media (min-width: 640px) { #menus-list { grid-template-columns: repeat(2, 1fr); } }
@media (min-width: 1024px) { #menus-list { grid-template-columns: repeat(3, 1fr); } }

h2 { font-size: clamp(1.5rem, 3vw, 2rem); }
h3 { font-size: clamp(1rem, 2vw, 1.5rem); color: var(--rouge-doux); }
p, label, button, select, input, textarea { font-size: clamp(0.875rem, 1.5vw, 1rem); }

@media (min-width: 640px) {
    h2 { font-size: clamp(2rem, 3.5vw, 2.5rem); }
    h3 { font-size: clamp(1.25rem, 2.5vw, 1.75rem); }
    p, label, button, select, input, textarea { font-size: clamp(1rem, 1.75vw, 1.125rem); }
}

@media (min-width: 1024px) {
    h2 { font-size: clamp(2.5rem, 4vw, 3rem); }
    h3 { font-size: clamp(1.5rem, 3vw, 2rem); }
}

.icon-svg {
    width: 1.5rem;
    height: 1.5rem;
    stroke: currentColor;
    stroke-width: 2;
    transition: transform 0.3s ease, stroke 0.3s ease;
}

.logo-container {
    display: flex;
    justify-content: center;
    padding: clamp(1rem, 2vw, 1.5rem);
    animation: logoFadeIn 1.2s ease-out;
}

.logo-svg {
    display: flex;
    justify-content: center;
    align-items: center; /* Center the logo vertically if it's the only item */
    padding: clamp(1rem, 2vw, 1.5rem);
    animation: logoFadeIn 1.2s ease-out;

    /* Styling for the logo's size based on your description */
    width: 250%; /* Take full width available */
    max-width: 200px; /* Cap the maximum width at 300px */
    height: auto; /* Maintain aspect ratio */
    aspect-ratio: 1 / 1; /* Ensures it's square, if your SVG is square */
    margin-left: auto; /* Center the block container */
    margin-right: auto; /* Center the block container */    
}
keyframes logoFadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
@media (max-width: 640px) {
    .logo-svg {
        width: 3rem;
        height: 3rem;
    }
}

.logo-container:hover .logo-svg {
    transform: rotate(10deg) scale(1.1);
}

@keyframes logoFadeIn {
    from { opacity: 0; transform: scale(0.8); }
    to { opacity: 1; transform: scale(1); }
}

.section-divider {
    height: 2px;
    background: linear-gradient(to right, transparent, var(--rouge-doux), transparent);
    margin: clamp(1rem, 2vw, 1.5rem) 0;
} 
.sidebar {
    width: 100%;
    max-width: 16rem;
    background: linear-gradient(to bottom, var(--glass-bg), rgba(162, 78, 78, 0.1));
    backdrop-filter: blur(12px);
    transition: transform 0.3s ease-in-out;
    box-shadow: var(--glow-shadow);
    position: fixed;
    top: 0;
    left: 0;
    height: 100%;
    z-index: 30;
}

.sidebar-hidden {
    transform: translateX(-100%);
}

.backdrop {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 20;
    transition: opacity 0.3s ease-in-out;
    opacity: 0;
    pointer-events: none;
}

.backdrop.visible {
    opacity: 1;
    pointer-events: auto;
}

@media (min-width: 640px) { 
    .sidebar { max-width: 18rem; } 
}

@media (min-width: 768px) {
    .sidebar {
        transform: translateX(0);
    }
    .sidebar-hidden {
        transform: translateX(-100%);
    }
    .backdrop {
        display: none;
    }
    #main-content {
        margin-left: 18rem;
    }
}

@media (min-width: 1024px) { 
    .sidebar { max-width: 20rem; }
    #main-content { margin-left: 20rem; } 
}
</style>

</head>
<body class="font-sans">
    <!-- Sidebar -->
    <nav id="sidebar" class="sidebar fixed top-0 left-0 h-full bg-glass shadow-lg z-30 sidebar-hidden md:sidebar">
        <div class="logo-container">
       <svg class="logo-svg" viewBox="0 0 300 300" xmlns="http://www.w3.org/2000/svg">
  <!-- Assiette -->
  <circle cx="150" cy="120" r="90" fill="var(--jaune-creme)" stroke="var(--rouge-brique)" stroke-width="5"/>

  <!-- Couteau -->
  <rect x="235" y="70" width="8" height="100" rx="4" fill="var(--rouge-brique)" />
  <path d="M243 70 Q255 120 243 170" fill="var(--rouge-brique)" />

  <!-- Fourchette -->
  <rect x="57" y="70" width="8" height="100" rx="4" fill="var(--rouge-brique)" />
  <g stroke="var(--rouge-brique)" stroke-width="2">
    <line x1="57" y1="75" x2="50" y2="90"/>
    <line x1="60" y1="75" x2="53" y2="90"/>
    <line x1="63" y1="75" x2="56" y2="90"/>
  </g>

  <!-- Cadran de l'horloge (petit cercle) -->
  <circle cx="150" cy="120" r="35" fill="white" stroke="var(--rouge-brique)" stroke-width="3"/>

  <!-- Index horaires -->
  <g stroke="var(--rouge-brique)" stroke-width="2">
    <line x1="150" y1="85" x2="150" y2="90"/>
    <line x1="150" y1="150" x2="150" y2="155"/>
    <line x1="115" y1="120" x2="120" y2="120"/>
    <line x1="180" y1="120" x2="185" y2="120"/>
  </g>

  <!-- Aiguilles de l'horloge -->
  <line x1="150" y1="120" x2="150" y2="95" stroke="var(--rouge-brique)" stroke-width="3" stroke-linecap="round"/>
  <line x1="150" y1="120" x2="170" y2="120" stroke="var(--rouge-brique)" stroke-width="2" stroke-linecap="round"/>
  <circle cx="150" cy="120" r="3" fill="var(--rouge-brique)" />

  <!-- Texte -->
  <text x="150" y="250" text-anchor="middle" font-size="24" font-family="Manrope, sans-serif" fill="var(--rouge-brique)">Daily Menu</text>
</svg>


        </div>
        <div class="p-4 border-b border-rouge-doux">
            <h1 class="text-2xl font-bold text-rouge-brique">Tableau de Bord</h1>
        </div>
        <button id="close-sidebar" class="md:hidden p-4 text-rouge-brique focus:outline-none">
            <i data-feather="x" class="icon-svg"></i>
        </button>
        <ul class="space-y-2 p-4">
            <li class="nav-item flex items-center space-x-2 p-3 rounded-lg cursor-pointer" data-section="overview">
                <i data-feather="grid" class="icon-svg text-rouge-doux"></i>
                <span>Vue d'ensemble</span>
            </li>
            <li class="nav-item flex items-center space-x-2 p-3 rounded-lg cursor-pointer" data-section="profile">
                <i data-feather="user" class="icon-svg text-rouge-doux"></i>
                <span>Profil</span>
            </li>
            <li class="nav-item flex items-center space-x-2 p-3 rounded-lg cursor-pointer" data-section="items">
                <i data-feather="package" class="icon-svg text-rouge-doux"></i>
                <span>Gestion des Items</span>
            </li>
            <li class="nav-item flex items-center space-x-2 p-3 rounded-lg cursor-pointer" data-section="menus">
                <i data-feather="menu" class="icon-svg text-rouge-doux"></i>
                <span>Gestion des Menus</span>
            </li>
            <li class="nav-item flex items-center space-x-2 p-3 rounded-lg cursor-pointer" data-section="qr-codes">
                <i data-feather="qr-code" class="icon-svg text-rouge-doux"></i>
                <span>QR Codes</span>
            </li>
            <li class="nav-item flex items-center space-x-2 p-3 rounded-lg cursor-pointer" data-section="reviews">
                <i data-feather="star" class="icon-svg text-rouge-doux"></i>
                <span>Avis</span>
            </li>
            <li class="nav-item flex items-center space-x-2 p-3 rounded-lg cursor-pointer" data-section="stats">
                <i data-feather="bar-chart-2" class="icon-svg text-rouge-doux"></i>
                <span>Statistiques</span>
            </li>
            <li class="nav-item flex items-center space-x-2 p-3 rounded-lg cursor-pointer" onclick="logout()">
                <i data-feather="log-out" class="icon-svg text-rouge-doux"></i>
                <span>Déconnexion</span>
            </li>
        </ul>
    </nav>

    <!-- Backdrop -->
    <div id="backdrop" class="fixed inset-0 bg-black bg-opacity-50 z-20 hidden md:hidden"></div>

    <!-- Main Content -->
    <main id="main-content" class="transition-all duration-300">
        <header class="flex justify-between items-center p-4 bg-glass shadow-sm">
            <button id="open-sidebar" class="md:hidden text-rouge-brique focus:outline-none">
                <i data-feather="menu" class="icon-svg"></i>
            </button>
            <div id="message" class="hidden text-white px-4 py-2 rounded bg-rouge-doux"></div>
        </header>

        <!-- Sections -->
        <section id="overview-section" class="section p-4 sm:p-6 fade-in-section">
            <h2 class="text-2xl sm:text-3xl font-bold mb-6">Vue d'ensemble</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="stat-card card-shadow">
                    <i data-feather="package" class="icon-svg"></i>
                    <h3 class="text-lg font-bold">Items</h3>
                    <p id="items-count" class="text-3xl">0</p>
                </div>
                <div class="stat-card card-shadow">
                    <i data-feather="menu" class="icon-svg"></i>
                    <h3 class="text-lg font-bold">Menus</h3>
                    <p id="menus-count" class="text-3xl">0</p>
                </div>
                <div class="stat-card card-shadow">
                    <i data-feather="qr-code" class="icon-svg"></i>
                    <h3 class="text-lg font-bold">Scans QR</h3>
                    <p id="qr-scans" class="text-3xl">0</p>
                </div>
                <div class="stat-card card-shadow">
                    <i data-feather="star" class="icon-svg"></i>
                    <h3 class="text-lg font-bold">Note Moyenne</h3>
                    <p id="avg-rating" class="text-3xl">0</p>
                </div>
            </div>
            <div class="section-divider"></div>
        </section>

        <section id="profile-section" class="section hidden p-4 sm:p-6 fade-in-section">
            <h2 class="text-2xl sm:text-3xl font-bold mb-6">Profil</h2>
            <form id="profile-form" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div class="form-group">
                    <i data-feather="user" class="input-icon"></i>
                    <input id="profile-name" type="text" required>
                    <label for="profile-name">Nom</label>
                    <span class="form-error">Ce champ est requis</span>
                </div>
                <div class="form-group">
                    <i data-feather="mail" class="input-icon"></i>
                    <input id="profile-email" type="email" required>
                    <label for="profile-email">Email</label>
                    <span class="form-error">Email invalide</span>
                </div>
                <div class="form-group">
                    <i data-feather="phone" class="input-icon"></i>
                    <input id="profile-phone" type="tel">
                    <label for="profile-phone">Téléphone</label>
                </div>
                <div class="form-group">
                    <i data-feather="map-pin" class="input-icon"></i>
                    <input id="profile-address" type="text" >
                    <label for="profile-address">Adresse</label>
                </div>
                <div class="form-group">
                    <i data-feather="navigation" class="input-icon"></i>
                    <input id="profile-latitude" type="number" step="any" e">
                    <label for="profile-latitude">Latitude</label>
                </div>
                <div class="form-group">
                    <i data-feather="navigation" class="input-icon"></i>
                    <input id="profile-longitude" type="number" step="any" >
                    <label for="profile-longitude">Longitude</label>
                </div>
                <div class="col-span-1 sm:col-span-2">
                    <button type="submit" class="btn-primary">Enregistrer</button>
                </div>
            </form>
            <div class="section-divider"></div>
        </section>

        <section id="items-section" class="section hidden p-4 sm:p-6 fade-in-section">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6">
                <h2 class="text-2xl sm:text-3xl font-bold">Gestion des Items</h2>
                <button onclick="openModal('create-item-modal')" class="btn-primary mt-2 sm:mt-0">Ajouter un Item</button>
            </div>
            <div class="filter-container">
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                    <div class="form-group">
                        <i data-feather="search" class="input-icon"></i>
                        <input id="item-search" type="text" ">
                        <label for="item-search">Rechercher</label>
                    </div>
                    <div class="form-group">
                        <i data-feather="filter" class="input-icon"></i>
                        <select id="item-category-filter" ">
                            <option value="">Toutes catégories</option>
                        </select>
                        <label for="item-category-filter">Catégorie</label>
                    </div>
                    <div class="form-group">
                        <i data-feather="calendar" class="input-icon"></i>
                        <select id="item-day-filter" ">
                            <option value="">Tous les jours</option>
                        </select>
                        <label for="item-day-filter">Jour</label>
                    </div>
                </div>
            </div>
            <div id="items-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                <!-- Exemple de carte d'item (répétée dynamiquement) -->
                <div class="item-card card-shadow">
                    <svg class="card-icon" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z" fill="var(--rouge-doux)"/>
                    </svg>
                    <h3 class="text-lg font-bold">Nom de l'item</h3>
                    <p>Prix: 5000 FCFA</p>
                    <p>Disponibilité: Oui</p>
                    <div class="action-buttons">
                        <button class="menu-button" onclick="editItem('item-id')" aria-label="Modifier">
                            <i data-feather="edit" class="icon-svg"></i>
                        </button>
                        <button class="menu-button" onclick="deleteItem('item-id')" aria-label="Supprimer">
                            <i data-feather="trash-2" class="icon-svg"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="section-divider"></div>
        </section>

        <section id="menus-section" class="section hidden p-4 sm:p-6 fade-in-section">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6">
                <h2 class="text-2xl sm:text-3xl font-bold">Gestion des Menus</h2>
                <button onclick="openModal('create-menu-modal')" class="btn-primary mt-2 sm:mt-0">Ajouter un Menu</button>
            </div>
            <div id="menus-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- Exemple de carte de menu (répétée dynamiquement) -->
                <div class="menu-card card-shadow">
                    <svg class="card-icon" viewBox="0 0 24 24">
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" fill="var(--rouge-doux)"/>
                    </svg>
                    <h3 class="text-lg font-bold">Nom du menu</h3>
                    <p>Description: Menu du jour</p>
                    <div class="action-buttons">
                        <button class="menu-button" onclick="editMenu('menu-id')" aria-label="Modifier">
                            <i data-feather="edit" class="icon-svg"></i>
                        </button>
                        <button class="menu-button" onclick="deleteMenu('menu-id')" aria-label="Supprimer">
                            <i data-feather="trash-2" class="icon-svg"></i>
                        </button>
                        <button class="menu-button" onclick="generateQR('menu-id')" aria-label="Générer QR">
                            <i data-feather="qr-code" class="icon-svg"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="section-divider"></div>
        </section>

        <section id="qr-codes-section" class="section hidden p-4 sm:p-6 fade-in-section">
            <h2 class="text-2xl sm:text-3xl font-bold mb-6">QR Codes</h2>
            <form id="qr-code-form" class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
                <div class="form-group">
                    <i data-feather="menu" class="input-icon"></i>
                    <select id="qr-menu" placeholder="Sélectionnez un menu">
                        <!-- Rempli dynamiquement -->
                    </select>
                    <label for="qr-menu">Menu</label>
                </div>
                <div class="flex items-end">
                    <button type="submit" class="btn-primary">Générer QR Code</button>
                </div>
            </form>
            <div id="qr-codes-list" class="space-y-4"></div>
            <div class="section-divider"></div>
        </section>

        <section id="reviews-section" class="section hidden p-4 sm:p-6 fade-in-section">
            <h2 class="text-2xl sm:text-3xl font-bold mb-6">Avis</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
                <div class="stat-card card-shadow p-6 rounded-lg text-center">
                    <i data-feather="star" class="icon-svg"></i>
                    <h3 class="text-lg font-bold">Note Moyenne</h3>
                    <p id="avg-rating-stats" class="text-3xl text-rouge-brique">0</p>
                </div>
                <div class="stat-card card-shadow p-6 rounded-lg text-center">
                    <i data-feather="message-circle" class="icon-svg"></i>
                    <h3 class="text-lg font-bold">Total Avis</h3>
                    <p id="total-reviews" class="text-3xl text-rouge-brique">0</p>
                </div>
                <div class="stat-card card-shadow p-6 rounded-lg text-center">
                    <i data-feather="thumbs-up" class="icon-svg"></i>
                    <h3 class="text-lg font-bold">Avis Positifs</h3>
                    <p id="positive-reviews" class="text-3xl text-rouge-brique">0</p>
                </div>
                <div class="stat-card card-shadow p-6 rounded-lg text-center">
                    <i data-feather="thumbs-down" class="icon-svg"></i>
                    <h3 class="text-lg font-bold">À Améliorer</h3>
                    <p id="improve-reviews" class="text-3xl text-rouge-brique">0</p>
                </div>
            </div>
            <div id="reviews-list" class="space-y-4"></div>
            <div class="section-divider"></div>
        </section>

        <section id="stats-section" class="section hidden p-4 sm:p-6 fade-in-section">
            <h2 class="text-2xl sm:text-3xl font-bold mb-6">Statistiques</h2>
            <h3 class="text-xl font-bold mb-4">Items Populaires</h3>
            <div id="popular-items" class="space-y-4">
                <div class="chart-placeholder">Placeholder pour graphique (à implémenter)</div>
            </div>
            <div class="section-divider"></div>
        </section>
    </main>

    <!-- Modals -->
    <div id="create-item-modal" class="modal fixed inset-0 flex items-center justify-center z-50 hidden" aria-hidden="true">
        <div class="modal-content">
            <div class="flex justify-between items-center p-4 border-b border-rouge-doux">
                <h2 class="text-xl font-bold">Créer un Item</h2>
                <button onclick="closeModal('create-item-modal')" class="text-rouge-brique focus:outline-none">
                    <i data-feather="x" class="icon-svg"></i>
                </button>
            </div>
            <form id="create-item-form" class="p-4 grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div class="form-group">
                    <i data-feather="edit-3" class="input-icon"></i>
                    <input id="item-name" type="text" required>
                    <label for="item-name">Nom</label>
                    <span class="form-error">Ce champ est requis</span>
                </div>
                <div class="form-group">
                    <i data-feather="dollar-sign" class="input-icon"></i>
                    <input id="item-price" type="number" " required>
                    <label for="item-price">Prix (FCFA)</label>
                    <span class="form-error">Prix invalide</span>
                </div>
                <div class="form-group">
                    <i data-feather="clock" class="input-icon"></i>
                    <input id="item-prep-time" type="number"  required>
                    <label for="item-prep-time">Temps de préparation (min)</label>
                    <span class="form-error">Temps invalide</span>
                </div>
                <div class="form-group">
                    <i data-feather="check-circle" class="input-icon"></i>
                    <select id="item-availability" >
                        <option value="true">Disponible</option>
                        <option value="false">Non disponible</option>
                    </select>
                    <label for="item-availability">Disponibilité</label>
                </div>
                <div class="form-group col-span-1 sm:col-span-2">
                    <i data-feather="file-text" class="input-icon"></i>
                    <textarea id="item-description" " rows="4"></textarea>
                    <label for="item-description">Description</label>
                </div>
                <div class="form-group">
                    <i data-feather="tag" class="input-icon"></i>
                    <select id="item-categories" multiple >
                        <!-- Rempli dynamiquement -->
                    </select>
                    <label for="item-categories">Catégories</label>
                </div>
                <div class="form-group">
                    <i data-feather="hash" class="input-icon"></i>
                    <select id="item-tags" multiple >
                        <!-- Rempli dynamiquement -->
                    </select>
                    <label for="item-tags">Tags</label>
                </div>
                <div class="form-group">
                    <i data-feather="calendar" class="input-icon"></i>
                    <select id="item-days" multiple >
                        <!-- Rempli dynamiquement -->
                    </select>
                    <label for="item-days">Jours de disponibilité</label>
                </div>
                <div class="col-span-1 sm:col-span-2">
                    <label class="block mb-1">Images</label>
                    <div class="drag-drop-area p-4 rounded text-center">
                        <p>Glissez-déposez des images ici ou</p>
                        <input type="file" id="image-upload" accept="image/*" multiple class="hidden">
                        <button type="button" onclick="document.getElementById('image-upload').click()" class="text-rouge-brique underline">sélectionnez des fichiers</button>
                    </div>
                    <div id="image-preview" class="grid grid-cols-2 sm:grid-cols-3 gap-2 mt-4"></div>
                </div>
                <div class="col-span-1 sm:col-span-2">
                    <label class="block mb-1">Ingrédients</label>
                    <div class="flex flex-col sm:flex-row gap-2 mb-2">
                        <div class="form-group flex-1">
                            <i data-feather="shopping-bag" class="input-icon"></i>
                            <select id="ingredient-select" >
                                <!-- Rempli dynamiquement -->
                            </select>
                            <label for="ingredient-select">Ingrédient</label>
                        </div>
                        <div class="form-group w-full sm:w-1/4">
                            <i data-feather="plus-circle" class="input-icon"></i>
                            <input id="ingredient-quantity" type="text" >
                            <label for="ingredient-quantity">Quantité</label>
                        </div>
                        <button type="button" onclick="addItemIngredient()" class="btn-primary">Ajouter</button>
                    </div>
                    <div id="item-ingredients" class="sortable-list space-y-2"></div>
                </div>
                <div class="col-span-1 sm:col-span-2 flex justify-end space-x-2">
                    <button type="button" onclick="closeModal('create-item-modal')" class="bg-rose-pale text-rouge-brique px-4 py-2 rounded">Annuler</button>
                    <button type="submit" class="btn-primary">Créer</button>
                </div>
            </form>
        </div>
    </div>

    <div id="create-menu-modal" class="modal fixed inset-0 flex items-center justify-center z-50 hidden" aria-hidden="true">
        <div class="modal-content">
            <div class="flex justify-between items-center p-4 border-b border-rouge-doux">
                <h2 class="text-xl font-bold">Créer un Menu</h2>
                <button onclick="closeModal('create-menu-modal')" class="text-rouge-brique focus:outline-none">
                    <i data-feather="x" class="icon-svg"></i>
                </button>
            </div>
            <form id="create-menu-form" class="p-4 grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div class="form-group">
                    <i data-feather="edit-3" class="input-icon"></i>
                    <input id="menu-name" type="text" placeholder="Entrez le nom du menu" required>
                    <label for="menu-name">Nom</label>
                    <span class="form-error">Ce champ est requis</span>
                </div>
                <div class="form-group col-span-1 sm:col-span-2">
                    <i data-feather="file-text" class="input-icon"></i>
                    <textarea id="menu-description" placeholder="Décrivez le menu" rows="4"></textarea>
                    <label for="menu-description">Description</label>
                </div>
                <div class="col-span-1 sm:col-span-2">
                    <label class="block mb-1">Items</label>
                    <div class="flex flex-col sm:flex-row gap-2 mb-2">
                        <div class="form-group flex-1">
                            <i data-feather="package" class="input-icon"></i>
                            <select id="item-select" placeholder="Sélectionnez un item">
                                <!-- Rempli dynamiquement -->
                            </select>
                            <label for="item-select">Item</label>
                        </div>
                        <button type="button" onclick="addMenuItem()" class="btn-primary">Ajouter</button>
                    </div>
                    <div id="menu-items" class="sortable-list space-y-2"></div>
                </div>
                <div class="col-span-1 sm:col-span-2">
                    <label class="block mb-1">Aperçu</label>
                    <div id="menu-preview" class="p-4 bg-jaune-creme rounded"></div>
                </div>
                <div class="col-span-1 sm:col-span-2 flex justify-end space-x-2">
                    <button type="button" onclick="closeModal('create-menu-modal')" class="bg-rose-pale text-rouge-brique px-4 py-2 rounded">Annuler</button>
                    <button type="submit" class="btn-primary">Créer</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        
//const frontendUrls = "https://dailymenu.onrender.com/";
const frontendUrls = "http://127.0.0.1:8000/";
let token = localStorage.getItem("token");
let selectedImages = [];
let selectedIngredients = [];
let selectedMenuItems = [];
let allItems = []; // Stockage des items pour le filtrage dynamique
loadOverview();
// Navigation
document.querySelectorAll(".nav-item").forEach(item => {
    item.addEventListener("click", () => {
        if (item.dataset.section) {
            showSection(item.dataset.section);
            document.querySelectorAll(".nav-item").forEach(i => i.classList.remove("active"));
            item.classList.add("active");
        }
    });
});
 document.addEventListener('DOMContentLoaded', () => {
            feather.replace();
            // Micro-interactions pour les boutons
            document.querySelectorAll('.btn-primary').forEach(btn => {
                btn.addEventListener('click', () => {
                    btn.style.transform = 'scale(0.95)';
                    setTimeout(() => { btn.style.transform = 'scale(1)'; }, 100);
                });
            });
            // Animation des sections au scroll
            const sections = document.querySelectorAll('.fade-in-section');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, { threshold: 0.1 });
            sections.forEach(section => observer.observe(section));
        });
function showSection(sectionId) {
    document.querySelectorAll(".section").forEach(section => section.classList.add("hidden"));
    document.getElementById(`${sectionId}-section`).classList.remove("hidden");
    if (token) {
        if (sectionId === "overview") loadOverview();
        if (sectionId === "profile") loadProfile();
        if (sectionId === "items") loadItems();
        if (sectionId === "menus") loadMenus();
        if (sectionId === "qr-codes") loadQRCodes();
        if (sectionId === "reviews") loadReviews();
        if (sectionId === "stats") loadStats();
    } else {
        window.location.href = frontendUrls + "start/";
    }
}

function showMessage(message, isError = false) {
    const msgDiv = document.getElementById("message");
    msgDiv.textContent = message;
    msgDiv.classList.remove("bg-bleu-clair", "bg-red-500");
    msgDiv.classList.add(isError ? "bg-red-500" : "bg-bleu-clair");
    msgDiv.classList.remove("hidden");
    setTimeout(() => msgDiv.classList.add("hidden"), 5000);
}

function logout() {
    localStorage.removeItem("token");
    token = null;
    window.location.href = frontendUrls + "";
}

// Modals
function openModal(modalId) {
    document.getElementById(modalId).classList.remove("hidden");
    if (modalId === "create-item-modal") loadItemModalData();
    if (modalId === "create-menu-modal") loadMenuModalData();
}

function closeModal(modalId) {
    document.getElementById(modalId).classList.add("hidden");
    if (modalId === "create-item-modal") {
        selectedImages = [];
        document.getElementById("image-preview").innerHTML = "";
        document.getElementById("item-ingredients").innerHTML = "";
    }
    if (modalId === "create-menu-modal") {
        selectedMenuItems = [];
        document.getElementById("menu-items").innerHTML = "";
        document.getElementById("menu-preview").innerHTML = "";
    }
}

// Drag and Drop
function handleDrop(event) {
    event.preventDefault();
    event.currentTarget.classList.remove("dragover");
    const files = event.dataTransfer.files;
    handleFiles(files);
}

function handleFileSelect(event) {
    handleFiles(event.target.files);
}

function handleFiles(files) {
    for (let file of files) {
        if (file.type.startsWith("image/")) {
            selectedImages.push(file);
            const reader = new FileReader();
            reader.onload = e => {
                const img = document.createElement("img");
                img.src = e.target.result;
                img.className = "w-full h-24 object-cover rounded";
                document.getElementById("image-preview").appendChild(img);
            };
            reader.readAsDataURL(file);
        }
    }
}

// Ingredients
async function loadItemModalData() {
    try {
        const [categories, tags, days, ingredients] = await Promise.all([
            fetch(frontendUrls + "api/categories", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json()),
            fetch(frontendUrls + "api/tags", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json()),
            fetch(frontendUrls + "api/jours").then(r => r.json()),
            fetch(frontendUrls + "api/ingredients").then(r => r.json())
        ]);
        const catSelect = document.getElementById("item-categories");
        catSelect.innerHTML = categories.map(c => `<option value="${c.id_category}">${c.name}</option>`).join("");
        const tagSelect = document.getElementById("item-tags");
        tagSelect.innerHTML = tags.map(t => `<option value="${t.id_tag}">${t.name}</option>`).join("");
        const daySelect = document.getElementById("item-days");
        daySelect.innerHTML = days.map(d => `<option value="${d.id_jour}">${d.nom}</option>`).join("");
        const ingSelect = document.getElementById("ingredient-select");
        ingSelect.innerHTML = ingredients.map(i => `<option value="${i.id_ingredient}">${i.nom_ingredient}</option>`).join("");
    } catch (error) {
        showMessage("Erreur lors du chargement des données", true);
    }
}

function addItemIngredient() {
    const select = document.getElementById("ingredient-select");
    const quantity = document.getElementById("ingredient-quantity").value;
    if (select.value && quantity) {
        selectedIngredients.push({ id: select.value, quantity });
        const div = document.createElement("div");
        div.className = "sortable-item flex justify-between items-center p-2 bg-jaune-creme rounded mb-2";
        div.innerHTML = `<span>${select.options[select.selectedIndex].text} - ${quantity}</span><button type="button" onclick="this.parentElement.remove(); selectedIngredients = selectedIngredients.filter(i => i.id !== '${select.value}')" class="text-red-500">X</button>`;
        document.getElementById("item-ingredients").appendChild(div);
        document.getElementById("ingredient-quantity").value = "";
    }
}
document.addEventListener('DOMContentLoaded', () => {
            feather.replace();
            // Micro-interactions pour les boutons
            document.querySelectorAll('.btn-primary, .menu-button').forEach(btn => {
                btn.addEventListener('click', () => {
                    btn.style.transform = 'scale(0.95)';
                    setTimeout(() => { btn.style.transform = 'scale(1)'; }, 100);
                });
            });
            // Animation des sections au scroll
            const sections = document.querySelectorAll('.fade-in-section');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, { threshold: 0.1 });
            sections.forEach(section => observer.observe(section));
            // Placeholder pour fonctions des boutons
            window.editItem = (id) => console.log(`Modifier item ${id}`);
            window.deleteItem = (id) => console.log(`Supprimer item ${id}`);
            window.editMenu = (id) => console.log(`Modifier menu ${id}`);
            window.deleteMenu = (id) => console.log(`Supprimer menu ${id}`);
            window.generateQR = (id) => console.log(`Générer QR pour menu ${id}`);
        });
function addIngredient() {
    const select = document.getElementById("ingredient-select");
    const quantity = document.getElementById("ingredient-quantity").value;
    const selectedOption = select.options[select.selectedIndex];
    const ingredientId = selectedOption.value;
    const ingredientName = selectedOption.text;
    if (!ingredientId || !quantity) {
        alert("Veuillez sélectionner un ingrédient et entrer une quantité.");
        return;
    }
    selectedIngredients.push({
        id: parseInt(ingredientId),
        name: ingredientName,
        quantity: quantity
    });
    const container = document.getElementById("item-ingredients");
    const div = document.createElement("div");
    div.className = "flex justify-between items-center bg-white p-2 rounded shadow mb-2";
    div.innerHTML = `
        <span>${ingredientName} - ${quantity}</span>
        <button onclick="removeIngredient(${ingredientId}, this)" class="text-red-500 font-bold">×</button>
    `;
    container.appendChild(div);
    select.selectedIndex = 0;
    document.getElementById("ingredient-quantity").value = "";
}

function removeIngredient(id, button) {
    const index = selectedIngredients.findIndex(i => i.id === id);
    if (index !== -1) {
        selectedIngredients.splice(index, 1);
        button.parentElement.remove();
    }
}

// Menu Items
async function loadMenuModalData() {
    try {
        const items = await fetch(frontendUrls + "api/items", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json());
        const select = document.getElementById("item-select");
        select.innerHTML = items.map(i => `<option value="${i.id_item}">${i.nom_plat}</option>`).join("");
    } catch (error) {
        showMessage("Erreur lors du chargement des items", true);
    }
}

function addMenuItem() {
    const select = document.getElementById("item-select");
    if (select.value) {
        selectedMenuItems.push(select.value);
        const div = document.createElement("div");
        div.className = "sortable-item flex justify-between items-center p-2 bg-jaune-creme rounded mb-2";
        div.innerHTML = `<span>${select.options[select.selectedIndex].text}</span><button type="button" onclick="this.parentElement.remove(); selectedMenuItems = selectedMenuItems.filter(i => i !== '${select.value}')" class="text-red-500">X</button>`;
        document.getElementById("menu-items").appendChild(div);
        updateMenuPreview();
    }
}

function updateMenuPreview() {
    const preview = document.getElementById("menu-preview");
    preview.innerHTML = selectedMenuItems.map(id => {
        const item = document.getElementById("item-select").querySelector(`option[value="${id}"]`);
        return `<div class="p-2">${item ? item.text : "Item"}</div>`;
    }).join("");
}

// Sortable Lists
function makeSortable(id) {
    const list = document.getElementById(id);
    list.addEventListener("dragstart", e => {
        e.target.classList.add("dragging");
        e.dataTransfer.setData("text/plain", e.target.dataset.id);
    });
    list.addEventListener("dragend", e => e.target.classList.remove("dragging"));
    list.addEventListener("dragover", e => e.preventDefault());
    list.addEventListener("drop", e => {
        e.preventDefault();
        const draggedId = e.dataTransfer.getData("text/plain");
        const dragged = list.querySelector(`[data-id="${draggedId}"]`);
        const target = e.target.closest(".sortable-item");
        if (target && dragged !== target) {
            const allItems = Array.from(list.querySelectorAll(".sortable-item"));
            const fromIndex = allItems.indexOf(dragged);
            const toIndex = allItems.indexOf(target);
            if (id === "item-ingredients") {
                selectedIngredients.splice(toIndex, 0, selectedIngredients.splice(fromIndex, 1)[0]);
            } else if (id === "menu-items") {
                selectedMenuItems.splice(toIndex, 0, selectedMenuItems.splice(fromIndex, 1)[0]);
            }
            list.insertBefore(dragged, toIndex > fromIndex ? target.nextSibling : target);
        }
    });
}

// Overview
async function loadOverview() {
    try {
        const [items, menus, qrCodes, reviews] = await Promise.all([
            fetch(frontendUrls + "api/items", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json()),
            fetch(frontendUrls + "api/menus", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json()),
            fetch(frontendUrls + "api/qrcodes", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json()),
            fetch(frontendUrls + "api/avis", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json())
        ]);
        document.getElementById("items-count").textContent = items.length;
        document.getElementById("menus-count").textContent = menus.length;
        document.getElementById("qr-scans").textContent = qrCodes.reduce((sum, qr) => sum + qr.scans, 0);
        document.getElementById("avg-rating").textContent = reviews.length ? (reviews.reduce((sum, r) => sum + r.note, 0) / reviews.length).toFixed(1) : "0";
    } catch (error) {
        showMessage("Erreur lors du chargement des données", true);
    }
}

// Profile
async function loadProfile() {
    try {
        const profile = await fetch(frontendUrls + "api/etablissement/me", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json());
        document.getElementById("profile-name").value = profile.nom_etablissement;
        document.getElementById("profile-email").value = profile.email_pro;
        document.getElementById("profile-phone").value = profile.numtel;
        document.getElementById("profile-address").value = profile.adresse_physique;
        document.getElementById("profile-latitude").value = profile.latitude;
        document.getElementById("profile-longitude").value = profile.longitude;
    } catch (error) {
        showMessage("Erreur lors du chargement du profil", true);
    }
}

document.getElementById("profile-form").addEventListener("submit", async e => {
    e.preventDefault();
    const data = {
        nom_etablissement: document.getElementById("profile-name").value,
        email_pro: document.getElementById("profile-email").value,
        numtel: document.getElementById("profile-phone").value,
        adresse_physique: document.getElementById("profile-address").value,
        latitude: parseFloat(document.getElementById("profile-latitude").value),
        longitude: parseFloat(document.getElementById("profile-longitude").value)
    };
    try {
        const response = await fetch(frontendUrls + "api/etablissement/me", {
            method: "PUT",
            headers: { "Content-Type": "application/json", "Authorization": `Bearer ${token}` },
            body: JSON.stringify(data)
        });
        if (response.ok) {
            showMessage("Profil mis à jour !");
        } else {
            showMessage((await response.json()).error, true);
        }
    } catch (error) {
        showMessage("Erreur serveur", true);
    }
});

// Items
async function loadItems() {
    try {
        const [items, categories, days] = await Promise.all([
            fetch(frontendUrls + "api/items", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json()),
            fetch(frontendUrls + "api/categories", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json()),
            fetch(frontendUrls + "api/jours").then(r => r.json())
        ]);
        allItems = items; // Stocker les items pour le filtrage
        const list = document.getElementById("items-list");
        const renderItems = (filteredItems) => {
            list.innerHTML = filteredItems.map(item => `
                <div class="menu-item p-4 rounded-lg card-shadow">
                    <div class="h-40 bg-rose-pale rounded-lg mb-4 flex items-center justify-center">
                        ${item.images.length ? `<img src="${item.images[0].url_image}" class="w-full h-full object-cover rounded-lg">` : `<span class="text-4xl">🍕</span>`}
                    </div>
                    <h3 class="font-bold text-rouge-brique mb-2">${item.nom_plat}</h3>
                    <p class="text-rouge-doux text-sm mb-2">${item.description || "Sans description"}</p>
                    <div class="flex justify-between items-center mb-3">
                        <span class="font-bold text-rouge-brique">${item.price} FCFA</span>
                        <span class="text-sm text-rouge-doux">⏱️ ${item.prep_time} min</span>
                    </div>
                    <div class="flex space-x-2">
                        <button class="bg-rouge-doux menu-button" aria-label="Modifier" title="Modifier" onclick="editItem('${item.id_item}')">
                            <svg class="icon-svg" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                        </button>
                        <button class="bg-rose-pale menu-button" aria-label="Dupliquer" title="Dupliquer" onclick="duplicateItem('${item.id_item}')">
                            <svg class="icon-svg" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                        </button>
                        <button class="bg-red-500 menu-button" aria-label="Supprimer" title="Supprimer" onclick="deleteItem('${item.id_item}')">
                            <svg class="icon-svg" viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                        </button>
                    </div>
                </div>
            `).join("");
        };
        renderItems(allItems);
        const catFilter = document.getElementById("item-category-filter");
        catFilter.innerHTML = `<option value="">Toutes catégories</option>` + categories.map(c => `<option value="${c.id_category}">${c.name}</option>`).join("");
        const dayFilter = document.getElementById("item-day-filter");
        dayFilter.innerHTML = `<option value="">Tous les jours</option>` + days.map(d => `<option value="${d.id_jour}">${d.nom}</option>`).join("");
        // Filtres dynamiques
        const searchInput = document.getElementById("item-search");
        const filterItems = () => {
            let filtered = allItems;
            const search = searchInput.value.toLowerCase();
            if (search) {
                filtered = filtered.filter(item => item.nom_plat.toLowerCase().includes(search));
            }
            const category = catFilter.value;
            if (category) {
                filtered = filtered.filter(item => item.categories.some(c => c.id_category == category));
            }
            const day = dayFilter.value;
            if (day) {
                filtered = filtered.filter(item => item.jours_disponibilite.some(d => d.id_jour == day));
            }
            renderItems(filtered);
        };
        searchInput.addEventListener("input", filterItems);
        catFilter.addEventListener("change", filterItems);
        dayFilter.addEventListener("change", filterItems);
    } catch (error) {
        showMessage("Erreur lors du chargement des items", true);
    }
}

document.getElementById("create-item-form").addEventListener("submit", async e => {
    e.preventDefault();
    const formData = new FormData();
    formData.append("nom_plat", document.getElementById("item-name").value);
    formData.append("description", document.getElementById("item-description").value);
    formData.append("price", document.getElementById("item-price").value);
    formData.append("prep_time", document.getElementById("item-prep-time").value);
    formData.append("disponibilite", document.getElementById("item-availability").value === "true");
    Array.from(document.getElementById("item-categories").selectedOptions).forEach(o => {
        formData.append("category_ids", o.value);
    });
    Array.from(document.getElementById("item-tags").selectedOptions).forEach(o => {
        formData.append("tag_ids", o.value);
    });
    Array.from(document.getElementById("item-days").selectedOptions).forEach(o => {
        formData.append("jour_ids", o.value);
    });
    const uniqueIngredients = [];
    const added = new Set();
    selectedIngredients.forEach(i => {
        if (!added.has(i.id)) {
            added.add(i.id);
            uniqueIngredients.push(i);
        }
    });
    uniqueIngredients.forEach(i => {
        formData.append("ingredient_ids", i.id);
        formData.append("quantites", i.quantity);
    });
    selectedImages.forEach(img => {
        formData.append("image_files", img);
    });
    try {
        const response = await fetch(frontendUrls + "api/items", {
            method: "POST",
            headers: { "Authorization": `Bearer ${token}` },
            body: formData
        });
        if (response.ok) {
            showMessage("Item créé avec succès !");
            closeModal("create-item-modal");
            showSection("items");
        } else {
            const errorData = await response.json();
            showMessage(errorData.error || "Erreur lors de la création", true);
        }
    } catch (err) {
        showMessage("Erreur serveur", true);
    }
});

async function editItem(id) {
    showMessage("Modification non implémentée", true);
}

async function duplicateItem(id) {
    try {
        const item = await fetch(frontendUrls + `api/items/${id}`, { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json());
        const formData = new FormData();
        formData.append("json", JSON.stringify({
            nom_plat: `${item.nom_plat} (Copie)`,
            description: item.description,
            price: item.price,
            prep_time: item.prep_time,
            disponibilite: item.disponibilite,
            category_ids: item.categories.map(c => c.id_category),
            tag_ids: item.tags.map(t => t.id_tag),
            jour_ids: item.jours_disponibilite.map(j => j.id_jour),
            ingredient_ids: item.ingredients.map(i => i.id_ingredient),
            quantites: item.ingredients.map((_, idx) => "N/A")
        }));
        const response = await fetch(frontendUrls + "api/items", {
            method: "POST",
            headers: { "Authorization": `Bearer ${token}` },
            body: formData
        });
        if (response.ok) {
            showMessage("Item dupliqué !");
            loadItems();
        } else {
            showMessage((await response.json()).error, true);
        }
    } catch (error) {
        showMessage("Erreur serveur", true);
    }
}

async function deleteItem(id) {
    if (!confirm("Supprimer cet item ?")) {
        return;
    }
    try {
        const response = await fetch(frontendUrls + `api/items/${id}`, {
            method: "DELETE",
            headers: { "Authorization": `Bearer ${token}` }
        });
        if (response.ok) {
            showMessage("Item supprimé avec succès");
            showSection("items");
        } else {
            const data = await response.json();
            showMessage("Erreur : " + (data.error || "suppression échouée"), true);
        }
    } catch (error) {
        showMessage("Erreur réseau pendant la suppression", true);
    }
}

// Menus
async function loadMenus() {
    try {
        const menus = await fetch(frontendUrls + "api/menus", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json());
        const list = document.getElementById("menus-list");
        list.innerHTML = menus.map(menu => `
            <div class="bg-white rounded-xl p-6 card-shadow">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-rouge-brique">${menu.nom}</h3>
                    <div class="flex space-x-2">
                        <button class="bg-rouge-doux menu-button" aria-label="Modifier" title="Modifier le menu" onclick="editMenu('${menu.id_menu}')">
                            <svg class="icon-svg" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                        </button>
                        <button class="bg-rose-pale menu-button" aria-label="Générer QR" title="Générer un QR code" onclick="generateQR('${menu.id_menu}')">
                            <svg class="icon-svg" viewBox="0 0 24 24"><path d="M4 4h6v6H4V4zm8 0h6v6h-6V4zm-8 8h6v6H4v-6zm8 0h6v6h-6v-6zm2-8h2v2h-2V4zm0 4h2v2h-2V8zm-4-4h2v2h-2V4zm0 4h2v2h-2V8zm-4 4h2v2H6v-2zm0 4h2v2H6v-2zm12-4h2v2h-2v-2zm0 4h2v2h-2v-2z"/></svg>
                        </button>
                        <button class="bg-rose-pale menu-button" aria-label="Exporter PDF" title="Exporter en PDF" onclick="exportPDF('${menu.id_menu}')">
                            <svg class="icon-svg" viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h8v4h4v12zm-6-3h-2v-2h2v2zm0-4h-2v-2h2v2zm-3 4h-2v-2h2v2zm0-4h-2v-2h2v2z"/></svg>
                        </button>
                        <button class="bg-rose-pale menu-button" aria-label="Partager" title="Partager le menu" onclick="shareMenu('${menu.id_menu}')">
                            <svg class="icon-svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"/></svg>
                        </button>
                        <button class="bg-red-500 menu-button" aria-label="Supprimer" title="Supprimer le menu" onclick="deleteMenu('${menu.id_menu}')">
                            <svg class="icon-svg" viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                        </button>
                    </div>
                </div>
                <p class="text-rouge-doux mb-4">${menu.items.length} items • Créé le ${new Date().toLocaleDateString()}</p>
                <div class="space-y-2">
                    ${menu.items.map(item => `<div class="flex justify-between"><span>${item.nom_plat}</span><span class="text-rouge-doux">${item.price} FCFA</span></div>`).join("")}
                </div>
            </div>
        `).join("");
    } catch (error) {
        showMessage("Erreur lors du chargement des menus", true);
    }
}

document.getElementById("create-menu-form").addEventListener("submit", async e => {
    e.preventDefault();
    const data = {
        nom: document.getElementById("menu-name").value,
        description: document.getElementById("menu-description").value,
        item_ids: selectedMenuItems
    };
    try {
        const response = await fetch(frontendUrls + "api/menus", {
            method: "POST",
            headers: { "Content-Type": "application/json", "Authorization": `Bearer ${token}` },
            body: JSON.stringify(data)
        });
        if (response.ok) {
            showMessage("Menu créé !");
            closeModal("create-menu-modal");
            loadMenus();
        } else {
            showMessage((await response.json()).error, true);
        }
    } catch (error) {
        showMessage("Erreur serveur", true);
    }
});

async function editMenu(id) {
    showMessage("Modification non implémentée", true);
}

async function deleteMenu(id) {
    if (!confirm("Supprimer ce menu ?")) {
        return;
    }
    try {
        const response = await fetch(frontendUrls + `api/menus/${id}`, {
            method: "DELETE",
            headers: { "Authorization": `Bearer ${token}` }
        });
        if (response.ok) {
            showMessage("Menu supprimé avec succès");
            loadMenus();
        } else {
            const data = await response.json();
            showMessage("Erreur : " + (data.error || "suppression échouée"), true);
        }
    } catch (error) {
        showMessage("Erreur réseau pendant la suppression", true);
    }
}

async function generateQR(menuId) {
    try {
        const response = await fetch(frontendUrls + "api/qrcodes", {
            method: "POST",
            headers: { "Content-Type": "application/json", "Authorization": `Bearer ${token}` },
            body: JSON.stringify({ menu_id: menuId })
        });
        if (response.ok) {
            showMessage("QR Code généré !");
            loadQRCodes();
        } else {
            showMessage((await response.json()).error, true);
        }
    } catch (error) {
        showMessage("Erreur", true);
    }
}

async function exportPDF(menuId) {
    try {
        const response = await fetch(frontendUrls + `api/menus/${menuId}/export-pdf`, {
            headers: { "Authorization": `Bearer ${token}` }
        });
        if (response.ok) {
            const blob = await response.blob();
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = `menu_${menuId}.pdf`;
            a.click();
            window.URL.revokeObjectURL(url);
            showMessage("PDF exporté !");
        } else {
            showMessage((await response.json()).error, true);
        }
    } catch (error) {
        showMessage("Erreur lors de l'exportation", true);
    }
}

async function shareMenu(menuId) {
    const url = frontendUrls + `menus/${menuId}`;
    navigator.clipboard.writeText(url);
    showMessage("Lien copié ! Partagez-le sur les réseaux sociaux.");
}

// QR Codes
async function loadQRCodes() {
    try {
        const qrCodes = await fetch(frontendUrls + "api/qrcodes", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json());
        const list = document.getElementById("qr-codes-list");
        list.innerHTML = qrCodes.map(q => `
            <div class="flex items-center justify-between p-4 bg-jaune-creme rounded-lg">
                <div class="flex items-center space-x-4">
                    <div class="w-16 h-16 bg-white rounded-lg flex-center border-2 border-rouge-doux">
                        <img src="${q.url}" alt="QR Code" class="w-full h-full">
                    </div>
                    <div>
                        <h4 class="font-bold text-rouge-brique">${q.menu_id}</h4>
                        <p class="text-rouge-doux text-sm">${q.scans} scans</p>
                    </div>
                </div>
                <div class="flex space-x-2">
                    <button class="bg-rouge-doux text-white px-3 py-2 rounded text-sm" onclick="downloadQR('${q.id_qrcode}')">Télécharger</button>
                    <button class="bg-rose-pale text-rouge-brique px-3 py-2 rounded text-sm" onclick="shareQR('${q.url}')">Partager</button>
                </div>
            </div>
        `).join("");
        const menuSelect = document.getElementById("qr-menu");
        const menus = await fetch(frontendUrls + "api/menus", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json());
        menuSelect.innerHTML = menus.map(m => `<option value="${m.id_menu}">${m.nom}</option>`).join("");
    } catch (error) {
        showMessage("Erreur lors du chargement des QR codes", true);
    }
}

document.getElementById("qr-code-form").addEventListener("submit", async e => {
    e.preventDefault();
    const data = {
        menu_id: document.getElementById("qr-menu").value
    };
    try {
        const response = await fetch(frontendUrls + "api/qrcodes", {
            method: "POST",
            headers: { "Content-Type": "application/json", "Authorization": `Bearer ${token}` },
            body: JSON.stringify(data)
        });
        if (response.ok) {
            showMessage("QR Code généré !");
            loadQRCodes();
        } else {
            showMessage((await response.json()).error, true);
        }
    } catch (error) {
        showMessage("Erreur", true);
    }
});

async function downloadQR(id) {
    const qr = await fetch(frontendUrls + `api/qrcodes/${id}`, { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json());
    const a = document.createElement("a");
    a.href = qr.url;
    a.download = `qr-${id}.png`;
    a.click();
}

async function shareQR(url) {
    navigator.clipboard.writeText(url);
    showMessage("URL du QR Code copié !");
}

// Avis
async function loadReviews() {
    try {
        const reviews = await fetch(frontendUrls + "api/avis", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json());
        const list = document.getElementById("reviews-list");
        list.innerHTML = reviews.map(r => `
            <div class="bg-white rounded-xl p-6 card-shadow">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-rouge-doux rounded-full flex items-center justify-center text-white font-bold">
                            ${r.id_personne.toString().charAt(0).toUpperCase()}
                        </div>
                        <div>
                            <h4 class="font-bold text-rouge-brique">Personne #${r.id_personne}</h4>
                            <div class="flex text-yellow-400">${"★".repeat(r.note)}${"☆".repeat(5-r.note)}</div>
                        </div>
                    </div>
                    <span class="text-rouge-doux text-sm">${r.date_avis}</span>
                </div>
                <p class="text-gray-700">Note : ${r.note}/5</p>
            </div>
        `).join("");
        document.getElementById("avg-rating-stats").textContent = reviews.length ? (reviews.reduce((a, r) => a + r.note, 0) / reviews.length).toFixed(1) : "0";
        document.getElementById("total-reviews").textContent = reviews.length;
        document.getElementById("positive-reviews").textContent = reviews.filter(r => r.note >= 4).length;
        document.getElementById("improve-reviews").textContent = reviews.filter(r => r.note < 4).length;
    } catch (error) {
        showMessage("Erreur lors du chargement des avis", true);
    }
}

// Stats
async function loadStats() {
    try {
        const items = await fetch(frontendUrls + "api/items", { headers: { "Authorization": `Bearer ${token}` } }).then(r => r.json());
        const popular = items.sort((a, b) => (b.views || 0) - (a.views || 0)).slice(0, 5);
        const popularList = document.getElementById("popular-items");
        popularList.innerHTML = popular.map(item => `
            <div class="flex justify-between items-center p-3 rounded-lg bg-jaune-creme">
                <span>${item.nom_plat}</span>
                <span class="font-bold text-rouge-brique">${item.views || 0} vues</span>
            </div>
        `).join("");
    } catch (error) {
        showMessage("Erreur lors du chargement des statistiques", true);
    }
}

// Initialisation
makeSortable("item-ingredients");
makeSortable("menu-items");
if (token) {
    showSection("overview");
} else {
    window.location.href = frontendUrls + "start/";
}
// Sidebar toggle functionality
const sidebar = document.getElementById('sidebar');
const backdrop = document.getElementById('backdrop');
const openSidebarBtn = document.getElementById('open-sidebar');
const closeSidebarBtn = document.getElementById('close-sidebar');

function toggleSidebar() {
    const isHidden = sidebar.classList.toggle('sidebar-hidden');
    backdrop.classList.toggle('visible', !isHidden);
    backdrop.classList.toggle('hidden', isHidden);
}

openSidebarBtn?.addEventListener('click', toggleSidebar);
closeSidebarBtn?.addEventListener('click', toggleSidebar);
backdrop?.addEventListener('click', toggleSidebar);

// Navigation item click handler
document.querySelectorAll('.nav-item').forEach(item => {
    item.addEventListener('click', () => {
        if (window.innerWidth < 768) {
            toggleSidebar();
        }
        if (item.dataset.section) {
            showSection(item.dataset.section);
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            item.classList.add('active');
        }
    });
});
    </script>
</body>
</html>